<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>HOMEWORK 9: PROBLEMS - PYTHON ADVANCED IO, MONTE CARLO &vert; COE 111L - SPRING 2017 - W 9-10 AM - WRW 209</title>
<meta name="description" content="Engineering Computation Lab">
<meta name="keywords" content="">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/ECL2017S/images/logo.png">
<meta name="twitter:title" content="Homework 9: Problems - Python advanced IO, Monte Carlo">
<meta name="twitter:description" content="Engineering Computation Lab">
<meta name="twitter:creator" content="@AmirShahmoradi">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Homework 9: Problems - Python advanced IO, Monte Carlo">
<meta property="og:description" content="Engineering Computation Lab">
<meta property="og:url" content="/ECL2017S/homework/9-problems-python-advanced-io-monte-carlo-interoperability">
<meta property="og:site_name" content="COE 111L - Spring 2017 - W 9-10 AM - WRW 209">
<meta property="og:image" content="/ECL2017S/images/">





<link rel="canonical" href="/ECL2017S/homework/9-problems-python-advanced-io-monte-carlo-interoperability">
<!-- <link href="/ECL2017S/feed.xml" type="application/atom+xml" rel="alternate" title="COE 111L - Spring 2017 - W 9-10 AM - WRW 209 Feed"> -->


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,600,300,800,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/ECL2017S/assets/css/vendor/font-awesome.min.css">
<link rel="stylesheet" href="/ECL2017S/assets/css/vendor/normalize.css">
<link rel="stylesheet" href="/ECL2017S/assets/css/vendor/nprogress.css">
<link rel="stylesheet" href="/ECL2017S/assets/css/vendor/foundation.min.css">
<link rel="stylesheet" href="/ECL2017S/assets/css/style.css">
<link rel="stylesheet" href="/ECL2017S/assets/css/post.css">

<!--Mathjax-->

<style TYPE="text/css">
code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
    }
});
MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<!-- Icons -->
<link rel="shortcut icon" href="/ECL2017S/favicon.ico">

<link href="/ECL2017S/assets/css/prismOkaidia.css" rel="stylesheet" />

<!--header anchor links-->
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

<style type="text/css">@media only screen and (min-width:43.75em){.notepad-post-content div>p:first-child:first-letter{float:left;font-size:4.688rem;line-height:4.375rem;padding-top:.25rem;padding-right:.5rem;padding-left:.188rem;font-family:serif}}</style>
</head>
<body class="post-template" itemscope itemtype="http://schema.org/WebPage">  

        <main id="notepad-post-container-simple" class="notepad-post-container-simple" role="main">
            <header class="notepad-post-header-simple">
                <div class="notepad-post-menu-header-simple">

                    <a class="notepad-blog-logo" href=https://www.cdslab.org target="_blank"><img src="/ECL2017S/images/logo.png" alt="cdslab.org" /></a>

                <div class="notepad-blog-menu">      
    <div class="notepad-mobile-menu show-for-small">
        <a href="#"><i class="fa fa-bars"></i></a>
    </div>
    <ul class="notepad-menu">
        <li class="notepad-mobile-close-btn show-for-small text-right">
            <a href="#"><i class="fa fa-times"></i></a>
        </li>

            <li>
                    <a href="/ECL2017S/">Home</a>
                 </li>

            <li>
                    <a href="/ECL2017S/highlights">Highlights</a>
                 </li>

            <li>
                    <a href="/ECL2017S/categories">Categories</a>
                 </li>

            <li>
                    <a href="/ECL2017S/about">About</a>
                 </li>
            
           <li><a href="/ECL2017S/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
    </ul>

</div>
            </div>

                <div class="notepad-post-title-simple row">
                    <div class="small-12 columns">
                        <div class="notepad-post-meta-simple">
                            <h2>Homework 9: Problems - Python advanced IO, Monte Carlo</h2>
                            <p>by <strong>Amir Shahmoradi</strong> &#8212;  <strong><time datetime="2017-04-19T00:00:00-05:00">19 Apr 2017</time></strong></p>
                        </div>
                    </div>
                </div>
            </header>

        
            <article class="notepad-post-content post tag-simple">
        
            <div style="text-align:justify;">
                <p>This homework aims at giving you some experience with Python’s tools for interacting with the World Wide Web and writing Monte Carlo simulations.</p>

<p><br /></p>

<hr />
<hr />

<p><br /></p>

<p><strong>Update:</strong> As I discussed in class, in order to avoid creating potential traffic on Professor Butler’s webpage, I have now uploaded all the necessary files on <a href="/ECL2017S/homework/9/swift/bat_time_table.html" target="_blank">this address</a> (don’t click on the links in this table, because it will take you to Professor Butler’s repository for this data. I have all the data already saved in our domain locally). So now, your goal is to first read the event-ID HTML table from</p>

<p><a href="/ECL2017S/homework/9/swift/bat_time_table.html" target="_blank">https://www.cdslab.org/ECL2017S/homework/9/swift/bat_time_table.html</a>.</p>

<p>Then, use the event-IDs in this table to generate web addresses like:</p>

<p><a href="/ECL2017S/homework/9/swift/GRB00100433_ep_flu.txt" target="_blank">https://www.cdslab.org/ECL2017S/homework/9/swift/GRB00100433_ep_flu.txt</a></p>

<p>in order to download these <code>.txt</code> files from the web. The rest of the homework is just as you would have done this problem as descibed below.</p>

<p><strong>1. </strong> <strong>Reading scientific data from web</strong>. Consider the webpage of Professor <a href="http://butler.lab.asu.edu/" target="_blank">Nat Butler</a> at Arizona State University. He has successfully written Python piplines for automated analysis of data from <a href="https://www.nasa.gov/mission_pages/swift/main" target="_blank">NASA’s Swift satellite</a>. For each <a href="https://en.wikipedia.org/wiki/Gamma-ray_burst" target="_blank">Gamma-Ray Burst (GRB)</a> detection that Swift makes, his pipline analyzes and reduces data for the burst and summarizes the results on his personal webpage, for example in <a href="http://butler.lab.asu.edu/swift/bat_spec_table.html" target="_blank">this table</a>.</p>

<p><strong>(A)</strong> Write a Python function named <code>fetchHtmlTable(link,outputPath)</code> that takes two arguments:</p>
<ol>
  <li>a web address (which will be this: <a href="http://butler.lab.asu.edu/swift/bat_time_table.html" target="_blank">http://butler.lab.asu.edu/swift/bat_time_table.html</a>), and,</li>
  <li>an output path to where you want the code save the resulting files.</li>
</ol>

<p>One file is exact HTML contained in the input webpage address, and a second file, which is the Table contained in this HTML address. To parse the HTML table in this address, you will need the Python code <a href="/ECL2017S/homework/9/parseTable.py" target="_blank">parseTable.py</a> also available and explained on <a href="https://www.summet.com/dmsi/html/readingTheWeb.html" target="_blank">this page</a>.  This parsed HTML table, will be in the form of a list, whose elements correspond to each row in the HTML table, and each row of element of this parsed table is itself another list, that contains the columns of the HTML table in that row. Output this table as well, in a separate file, in a formatted style, meaning that each element of table in a row has a space of 30 characters for itself (or something appropriate as you wish, e.g., <code>'{:&gt;30}'.format(item)</code>). You can see an example output of the code <a href="/ECL2017S/homework/9/bat_time_table.html" target="_blank">here for the HTML output file</a>, and <a href="/ECL2017S/homework/9/bat_time_table.html.tab" target="_blank">here for parse HTML table</a>.</p>

<p><strong>(B)</strong> Now, if you look at the content of the file that your function has generated (once you run it), you will see something like the following,</p>
<pre><code class="language-text">                   GRB (Trig#)               Trig_Time (SOD)               Time Region [s]                          T_90                          T_50                       rT_0.90                       rT_0.50                       rT_0.45                          T_av                         T_max                        T_rise                        T_fall                           Cts                       Rate_pk                          Band                              
       GRB170406x   (00745966)                     44943.130                -40.63-&gt;887.37              881.000 +/-7.697             549.000 +/-25.558             280.000 +/-13.432              124.000 +/-5.751              109.000 +/-4.997             433.667 +/-15.557            877.870 +/-367.494            890.500 +/-366.900              0.000 +/-366.630                6.082 +/-0.344               0.018 +/-0.0065                     15-350keV
       GRB170402x   (00745090)                     38023.150                  54.35-&gt;66.35                9.000 +/-2.096                5.000 +/-1.490                7.000 +/-1.535                4.000 +/-0.640                3.000 +/-0.559               60.964 +/-1.316               58.850 +/-2.417                1.500 +/-2.894                7.500 +/-2.720                0.162 +/-0.045               0.022 +/-0.0106                     15-350keV
       GRB170401x   (00745022)                     68455.150                 -19.63-&gt;71.49               78.880 +/-5.224               39.440 +/-4.168               41.480 +/-3.823               18.360 +/-1.585               16.320 +/-1.341               29.541 +/-2.857              24.910 +/-24.386              37.740 +/-24.251              41.140 +/-23.977                1.181 +/-0.122               0.024 +/-0.0130                     15-350keV
       GRB170331x   (00744791)                      6048.440                 9.835-&gt;35.875               20.160 +/-1.285               10.290 +/-0.914               14.070 +/-1.041                5.880 +/-0.415                5.040 +/-0.359               21.461 +/-0.598               12.460 +/-5.633                0.525 +/-5.718               19.635 +/-5.840                1.875 +/-0.154               0.134 +/-0.0408                     15-350keV
</code></pre>
<p><br />
Now write another function that reads the events’ unique numbers that appear in this table in parentheses (e.g., 00745966 is the first in table), and puts this number in place of <code>event_id</code> in this web address template: <code>http://butler.lab.asu.edu/swift/event_id/bat/ep_flu.txt</code>.</p>

<p>Now note that, for some events, this address exists, for example,</p>

<p><a href="http://butler.lab.asu.edu/swift/00745966/bat/ep_flu.txt" target="_blank">http://butler.lab.asu.edu/swift/00745966/bat/ep_flu.txt</a>,</p>

<p>which is a text file named <code>ep_flu.txt</code>. For some other events, this address might not exist, for example,</p>

<p><a href="http://butler.lab.asu.edu/swift/00680331/bat/ep_flu.txt" target="_blank">http://butler.lab.asu.edu/swift/00680331/bat/ep_flu.txt</a>,</p>

<p>in which case your code will have to raise a <code>urllib.request.HTTPError</code> exception. Write your code such that it can smoothly skip these exceptions. Write your code such that it saves all those existing text files on your local computer, in a file-name format like <a href="/ECL2017S/homework/9/GRB00100433_ep_flu.txt" target="_blank">this example: <code>GRB00100433_ep_flu.txt</code></a> (A total of 938 files exist).</p>

<p><strong>(C)</strong> Now write a third function, that reads all of these files in your directory, one by one, as numpy arrays, and plots the content of all of them together, on a single scatter plot like the following,</p>

<figure>
	<img src="/ECL2017S/homework/9/ep_flu.png" width="900" />
</figure>
<p><br /></p>

<p>To achieve this goal, your function should start like the following,</p>
<pre><code class="language-python">def plotBatFiles(inPath,figFile):
    import os
    import numpy as np, os
    import matplotlib.pyplot as plt
    ax = plt.gca()  # generate a plot handle
    ax.set_xlabel('Fluence [ ergs/cm^2 ]') # set X axis title
    ax.set_ylabel('Epeak [ keV ]')  # set Y axis title
    ax.axis([1.0e-8, 1.0e-1, 1.0, 1.0e4]) # set axix limits [xmin, xmax, ymin, ymax]
    plt.hold('on')  # add all data files to the same plot
    counter = 0     # counts the number of events
</code></pre>
<p><br />
where <code>inPath</code> and <code>figFile</code> are the path to the directory containing the files, and the name and path to the output figure file. You will have to use <code>os.listdir(inPath)</code> to get a list of all files in your input directory. Then loop over this list of files, and use only those that end with <code>ep_flu.txt</code> because that’s how you saved those files, e.g.,</p>
<pre><code class="language-python">for file in os.listdir(inPath):
        if file.endswith("ep_flu.txt"):
            # rest of your code ... 
</code></pre>
<p><br />
But now, you have to also make sure that your input data does indeed contain some numerical data, because some files do contain anything, although they exist, like <a href="/ECL2017S/homework/9/GRB00559075_ep_flu.txt" target="_blank">this file: ``</a>. To do so, you will have to perform a test on the content of file, once you read it as numpy array, like the following,</p>
<pre><code class="language-python">            data = np.loadtxt(os.path.join(inPath, file), skiprows=1)
            if data.size!=0 and all(data[:,1]&lt;0.0):
                # then plot data
</code></pre>
<p><br />
the condition <code>all(data[:,1]&lt;0.0)</code> is rather technical. It makes sure that all values are positive on the second column. Once you have done all these checks, you have to do one final manipulation of data, that is, the data in these files on the second column is actually the log of data, so have to get the <code>exp()</code> value to plot it (because plot is log-log). To do so you can use,</p>
<pre><code class="language-python">            data[:,1] = np.exp(data[:,1])
</code></pre>
<p><br />
and then finally,</p>
<pre><code class="language-python">            ax.scatter(data[:,1],data[:,0],s=1,alpha=0.05,c='r',edgecolors='none')
</code></pre>
<p><br />
which will add the data for the current file to the plot. At the end, you will have to set a title for your plot as well, and save your plot,</p>
<pre><code class="language-python">    ax.set_title('Plot of Epeak vs. Fluence for {} Swift GRB events'.format(counter))
    plt.savefig(figFile)
</code></pre>
<p><br />
Note that the variable <code>counter</code> contains the total number of events for which the text files exists on the website, <strong>and</strong> the file contained some data (i.e., was not empty).</p>

<p><strong>Question:</strong> What does <code>alpha=0.05</code> and <code>s=1</code> do in the following scatter plot command? (Vary their values to see what happens)</p>

<p><br /></p>

<hr />
<hr />

<p><br /></p>

<p><strong>2. </strong> <strong>Simulating a fun Monte Carlo game.</strong> Suppose you’re on a game show, and you’re given the choice of three doors:</p>

<figure>
	<img src="/ECL2017S/homework/9/Monty_1.png" width="600" />
</figure>
<p><br /></p>

<p>Behind one door is a car; behind the two others, goats. You pick a door, say No. 1, and the host of the show opens another door, say No. 3, which has a goat.</p>

<figure>
	<img src="/ECL2017S/homework/9/Monty_open_door.png" width="600" />
</figure>
<p><br /></p>

<p>He then says to you, “Do you want to pick door No. 2?”.</p>

<p><strong>Question: What would you do?</strong><br />
Is it to your advantage to switch your choice from door 1 to door 2? Is it to your advantage, <strong>in the long run, for a large number of game tries</strong>, to switch to the other door?</p>

<p>Now whatever your answer is, I want you to check/prove your answer by a Monte Carlo simulation of this problem. Make a plot of your simulation for $ngames=100000$ repeat of this game, that shows, in the long run, on average, what is the probability of winning this game if you switch your choice, and what is the probability of winning, if you do not switch to the other door.</p>

<p><br /><br /></p>

            </div>
        </article>
        <div class="cf"></div>
<div class="row text-center">
    <section class="notepad-post-share">
        <a class="twitter-icon" href="https://twitter.com/intent/tweet?text=&quot;Homework 9: Problems - Python advanced IO, Monte Carlo&quot;%20/ECL2017S/homework/9-problems-python-advanced-io-monte-carlo-interoperability%20via%20&#64;AmirShahmoradi"
            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
            <i class="fa fa-twitter"></i>
        </a>
        <a class="facebook-icon" href="https://www.facebook.com/sharer/sharer.php?u=/ECL2017S/homework/9-problems-python-advanced-io-monte-carlo-interoperability"
            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
            <i class="fa fa-facebook"></i>
        </a>
        <a class="google-icon" href="https://plus.google.com/share?url=/ECL2017S/homework/9-problems-python-advanced-io-monte-carlo-interoperability"
           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+">
            <i class="fa fa-google-plus"></i>
        </a>
    </section>
</div>
        <div class="cf"></div>
        
<div class="notepad-author-info">
    <div class="row">
        <section class="notepad-post-author small-12 columns">
            <a href="https://www.shahmoradi.org" target="_blank">
                <img src="/ECL2017S/images/AmirShahmoradi.png" class="notepad-post-author-avatar" alt="Amir Shahmoradi's photo">
            </a>
            <span class="author-label">Author</span>
            <h1>Amir Shahmoradi</h1>
            <p><a href="mailto:shahmoradi@utexas.edu" class="author-website">shahmoradi@utexas.edu</a></p>
            <p>Genius is 99% perspiration and 1% inspiration</p>
        </section>
    </div>
</div> 
        
        <div class="cf"></div>
        
        <section class="notepad-disqus row">
    <div class="small-12 columns">
        <h1 class="notepad-comments-header">Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'shahmoradi'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
</section>

        <div class="cf"></div>

    <footer class="notepad-site-footer">
    <div class="copyright">
         <!-- <section>Last updated 2019 / 07 / 15</section></br> -->
         <section>Last updated Monday, 15 Jul 2019 at 03:26 PM CST</section></br>
         <section>All content exclusively maintained by <a href=https://www.shahmoradi.org target="_blank">Amir Shahmoradi</a> <!-- &copy;--> </section></br>
         <section><a class="icon-ghost" href="https://www.ae.utexas.edu/" target="_blank">Department of Aerospace Engineering and Engineering Mechanics</a></section></br>
         <section><a class="icon-ghost" href="https://www.ices.utexas.edu/" target="_blank">Institute for Computational Engineering and Sciences | POB 6.328</a></section></br>
         <section><a class="icon-ghost" href="https://www.utexas.edu/" target="_blank">The University of Texas at Austin</a></section></br>
         <section>201 E 24th Street, Stop C0200</section></br>
         <section>Austin, TX 78712-1229</section>
    </div>
    <div class="social-icons">
        
        
        <a href="https://twitter.com/AmirShahmoradi" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-twitter fa-stack-1x"></i>
            </span>
        </a>
        
        
        
        
        <a href="https://github.com/shahmoradi" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-github fa-stack-1x"></i>
            </span>
        </a>
        
        
        <!-- Start of statc -->
        <div style="color: #000000; float: none; width: 100%; padding-top: 1rem;">
            <span style="font-size:0.8em">visitor count: 
                <script type="text/javascript">
                    var sc_project=11514220; 
                    var sc_invisible=0; 
                    var sc_security="1557d578"; 
                    var sc_text=3; 
                    var scJsHost = (("https:" == document.location.protocol) ?
                    "https://secure." : "http://www.");
                    document.write("<sc"+"ript type='text/javascript' src='" +
                    scJsHost+
                    "statcounter.com/counter/counter.js'></"+"script>");
                </script>
            </span>
        </div>
        <!-- End of statc -->
    </div>
    <div class="cf"></div>
</footer> 
</main>    
<!--dynamic page header-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="/ECL2017S/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>
  <script src="/ECL2017S/assets/js/vendor/modernizr.js"></script>
  <script src="/ECL2017S/assets/js/foundation.min.js"></script>
  
  <script src="/ECL2017S/assets/js/notepad.js"></script>
  <script src="/ECL2017S/assets/js/scripts.min.js"></script>
  <script src="/ECL2017S/assets/js/vendor/nprogress.js"></script>
  
  <script>
    $(document).foundation();
  </script>
  <script type='text/javascript'>console.log("N/A");</script>
  <script type='text/javascript'>console.log("https://www.cdslab.org/");</script>

<!--header anchor links-->
<script src="/ECL2017S/assets/js/autoAnchorLink.js"></script>

<!-- <script src="/ECL2017S/assets/js/prismOkaidia.js"></script>
<script src="/ECL2017S/assets/js/prismTwilight.js"></script>
<script src="/ECL2017S/assets/js/prismDefault.js"></script>
 -->
<script src="/ECL2017S/assets/js/prismCoy.js"></script>
<!-- Start of Ganal -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-67460905-1', 'auto');
    ga('send', 'pageview');
</script>
<!-- End of Ganal --> 
<!--automatic Table of Content.-->
<script src="/ECL2017S/assets/js/autoTOC.js"></script>
</body>
</html>
